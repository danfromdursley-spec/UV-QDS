<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>QDS Avian Magnetoreception Lab v2</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: radial-gradient(circle at top, #050816 0%, #02040a 45%, #010109 100%);
    color: #e9faff;
  }
  .wrapper {
    max-width: 800px;
    margin: 0 auto;
    padding: 16px 12px 40px;
  }
  h1 {
    text-align: center;
    color: #4bf5ff;
    text-shadow: 0 0 12px rgba(75,245,255,0.7);
    font-size: 1.7rem;
    margin-bottom: 6px;
  }
  h2 {
    font-size: 1.05rem;
    margin: 0 0 8px;
    color: #c9e8ff;
  }
  .subtitle {
    text-align: center;
    font-size: 0.9rem;
    color: #88c7ff;
    margin-bottom: 16px;
  }
  .card {
    background: radial-gradient(circle at top left, #111827, #020617 65%);
    border-radius: 20px;
    padding: 14px 14px 16px;
    margin-bottom: 14px;
    box-shadow:
      0 0 18px rgba(0,255,255,0.18),
      0 0 40px rgba(0,0,0,0.8);
    border: 1px solid rgba(56,189,248,0.18);
  }
  .slider-row {
    margin-bottom: 10px;
  }
  .slider-label {
    font-size: 0.93rem;
    margin-bottom: 4px;
    display: flex;
    justify-content: space-between;
    gap: 8px;
  }
  .value-pill {
    font-size: 0.78rem;
    padding: 2px 8px;
    border-radius: 999px;
    background: rgba(15,118,110,0.3);
    color: #a5f3fc;
  }
  input[type="range"] {
    width: 100%;
    -webkit-appearance: none;
    appearance: none;
    height: 6px;
    border-radius: 999px;
    background: linear-gradient(90deg,#0ea5e9,#22c55e);
    outline: none;
  }
  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: #f97316;
    border: 2px solid #e0f2fe;
    box-shadow: 0 0 10px rgba(249,115,22,0.8);
  }
  .kernel-display {
    text-align: center;
    font-size: 1.6rem;
    font-weight: 600;
    color: #bbf7d0;
    text-shadow: 0 0 10px rgba(22,163,74,0.8);
  }
  .kernel-caption {
    font-size: 0.8rem;
    color: #bae6fd;
    margin-top: 4px;
  }
  .compass-shell {
    margin-top: 10px;
    display: flex;
    justify-content: center;
  }
  .compass {
    width: 220px;
    height: 220px;
    border-radius: 50%;
    border: 4px solid #22d3ee;
    box-shadow: 0 0 16px rgba(34,211,238,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    background: radial-gradient(circle at 30% 20%, #0f172a, #020617 70%);
  }
  .compass-line {
    width: 4px;
    height: 80px;
    background: #ef4444;
    border-radius: 999px;
    transform-origin: bottom center;
    position: absolute;
    bottom: 50%;
  }
  .compass-label {
    position: absolute;
    top: 6px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.75rem;
    color: #e5e7eb;
    letter-spacing: 0.14em;
  }
  .status-bar {
    margin-top: 10px;
    padding: 8px 10px;
    border-radius: 999px;
    font-size: 0.86rem;
    text-align: center;
    border: 1px solid rgba(56,189,248,0.4);
    box-shadow: 0 0 16px rgba(59,130,246,0.35);
  }
  .status-ok {
    background: radial-gradient(circle at top, rgba(22,163,74,0.16), rgba(6,95,70,0.65));
    color: #bbf7d0;
  }
  .status-warn {
    background: radial-gradient(circle at top, rgba(250,204,21,0.16), rgba(161,98,7,0.7));
    color: #fef9c3;
  }
  .status-bad {
    background: radial-gradient(circle at top, rgba(248,113,113,0.16), rgba(127,29,29,0.85));
    color: #fee2e2;
  }
  .button-stack {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .btn {
    border: none;
    border-radius: 999px;
    padding: 10px 14px;
    font-size: 0.95rem;
    font-weight: 600;
    background: linear-gradient(120deg,#0ea5e9,#22c55e);
    color: #0b1020;
    box-shadow:
      0 0 12px rgba(34,197,94,0.7),
      0 0 26px rgba(14,165,233,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }
  .btn span {
    font-size: 1.1rem;
  }
  .btn-outline {
    background: transparent;
    color: #e0f2fe;
    border: 1px solid rgba(56,189,248,0.7);
    box-shadow: 0 0 12px rgba(56,189,248,0.4);
  }
  .note {
    font-size: 0.78rem;
    color: #9ca3af;
    margin-top: 4px;
  }
</style>
</head>
<body>
<div class="wrapper">
  <h1>ü¶Ö QDS Avian Magnetoreception Lab v2</h1>
  <div class="subtitle">
    Toy model of a bird‚Äôs cryptochrome compass under the QDS kernel.
  </div>

  <!-- CONTROL SLIDERS -->
  <div class="card">
    <h2>Core Quantum Parameters</h2>

    <div class="slider-row">
      <div class="slider-label">
        <span>1) œÑ<sub>c</sub> ‚Äî Coherence Time</span>
        <span id="tcValue" class="value-pill">1.0 ms</span>
      </div>
      <input id="tcSlider" type="range" min="0.1" max="5" step="0.1" value="1.0">
    </div>

    <div class="slider-row">
      <div class="slider-label">
        <span>2) Œª<sub>c</sub> ‚Äî Spatial Coherence</span>
        <span id="lcValue" class="value-pill">1.5 nm</span>
      </div>
      <input id="lcSlider" type="range" min="0.5" max="10" step="0.1" value="1.5">
    </div>

    <div class="slider-row">
      <div class="slider-label">
        <span>3) EM Noise Level</span>
        <span id="noiseValue" class="value-pill">0.10</span>
      </div>
      <input id="noiseSlider" type="range" min="0" max="1" step="0.01" value="0.10">
    </div>
  </div>

  <!-- KERNEL / COMPASS -->
  <div class="card">
    <h2>QDS Kernel & Compass</h2>
    <div class="kernel-display" id="kernelValue">K = 0.000</div>
    <div class="kernel-caption">Effective substrate support for cryptochrome pair.</div>

    <div class="compass-shell">
      <div class="compass">
        <div class="compass-label">N</div>
        <div id="compassNeedle" class="compass-line"></div>
      </div>
    </div>
    <div id="navStatus" class="status-bar status-warn">
      Navigation Status: Initialising‚Ä¶
    </div>
  </div>

  <!-- CRYPTOCHROME ACTIVATION VISUAL -->
  <div class="card">
    <h2>Cryptochrome Activation</h2>
    <div id="activationDot"
         style="width:56px;height:56px;border-radius:50%;
                margin:8px auto 2px;
                background:radial-gradient(circle at 30% 20%,#4c1d95,#020617);
                box-shadow:0 0 0 rgba(96,165,250,0.0),
                           0 0 0 rgba(56,189,248,0.0);">
    </div>
    <div class="note">
      Glow & pulsing strength scale with K. In a real bird this maps to singlet‚Äìtriplet yield contrast.
    </div>
  </div>

  <!-- PRESETS -->
  <div class="card">
    <h2>Environment Presets</h2>
    <div class="button-stack">
      <button class="btn" onclick="setPreset('forest')">
        <span>üå≤</span> Quiet Forest
      </button>
      <button class="btn" onclick="setPreset('urban')">
        <span>üèôÔ∏è</span> Urban EM Noise
      </button>
      <button class="btn" onclick="setPreset('storm')">
        <span>‚õàÔ∏è</span> Magnetic Storm
      </button>
      <button class="btn" onclick="setPreset('flare')">
        <span>‚òÄÔ∏è</span> Solar Flare
      </button>
      <button class="btn" onclick="setPreset('lab')">
        <span>üß™</span> Perfect Quantum Lab
      </button>
      <button class="btn btn-outline" onclick="toggle5G()">
        <span>üì°</span> Toggle 5G Tower Noise
      </button>
      <button class="btn btn-outline" onclick="toggleDayNight()">
        <span>üåû</span> Day / Night Switch
      </button>
      <button class="btn btn-outline" onclick="exportSnapshot()">
        <span>üì∏</span> Export Lab Snapshot
      </button>
    </div>
  </div>

  <div class="note">
    This is an educational toy, not a full biophysics simulator ‚Äî but the regimes match the QDS avian kernel notes.
  </div>
</div>

<script>
  const tcSlider   = document.getElementById('tcSlider');
  const lcSlider   = document.getElementById('lcSlider');
  const noiseSlider= document.getElementById('noiseSlider');

  const tcValue    = document.getElementById('tcValue');
  const lcValue    = document.getElementById('lcValue');
  const noiseValue = document.getElementById('noiseValue');
  const kernelValue= document.getElementById('kernelValue');
  const navStatus  = document.getElementById('navStatus');
  const compassNeedle = document.getElementById('compassNeedle');
  const activationDot = document.getElementById('activationDot');

  let fiveGOn = false;
  let isNight = false;

  function updateLabels() {
    tcValue.textContent    = tcSlider.value + ' ms';
    lcValue.textContent    = lcSlider.value + ' nm';
    noiseValue.textContent = Number(noiseSlider.value).toFixed(2);
  }

  function computeKernel() {
    const tc   = parseFloat(tcSlider.value);
    const lc   = parseFloat(lcSlider.value);
    const baseNoise = parseFloat(noiseSlider.value);
    const extraNoise = fiveGOn ? 0.15 : 0;
    const noise = Math.min(1, baseNoise + extraNoise);

    // simple toy formula
    const K = (tc * lc) / (1 + 8 * noise * noise);
    kernelValue.textContent = 'K = ' + K.toFixed(3);

    // compass and status
    let angle;   // degrees, 0 = north
    let statusClass, statusText;

    if (K > 8) {
      angle = isNight ? 0 : 10;
      statusClass = 'status-ok';
      statusText  = 'Navigation Status: Stable orientation ‚Äì migratory corridor locked.';
    } else if (K > 3) {
      angle = isNight ? 25 : 40;
      statusClass = 'status-warn';
      statusText  = 'Navigation Status: Noisy but usable compass ‚Äì flock cohesion reduced.';
    } else if (K > 1) {
      angle = 90;
      statusClass = 'status-warn';
      statusText  = 'Navigation Status: Strongly perturbed ‚Äì birds detour or delay migration.';
    } else {
      angle = 160;
      statusClass = 'status-bad';
      statusText  = 'Navigation Status: Disoriented ‚Äì compass collapse / random headings.';
    }

    compassNeedle.style.transform = 'rotate(' + angle + 'deg)';

    navStatus.classList.remove('status-ok','status-warn','status-bad');
    navStatus.classList.add(statusClass);
    navStatus.textContent = statusText;

    // cryptochrome glow
    const glow = Math.min(1, K / 8);
    const blur = 12 + glow * 18;
    const spread = 2 + glow * 6;
    activationDot.style.boxShadow =
      `0 0 ${blur}px ${spread}px rgba(56,189,248,${0.35 + glow*0.4}),
       0 0 ${blur+6}px ${spread+2}px rgba(129,230,217,${0.25 + glow*0.3})`;
    activationDot.style.background =
      `radial-gradient(circle at 30% 20%, rgba(129,230,217,1), #020617)`;
  }

  function setPreset(name) {
    if (name === 'forest') {
      tcSlider.value = 2.2;
      lcSlider.value = 2.5;
      noiseSlider.value = 0.12;
    } else if (name === 'urban') {
      tcSlider.value = 1.0;
      lcSlider.value = 1.8;
      noiseSlider.value = 0.45;
    } else if (name === 'storm') {
      tcSlider.value = 0.8;
      lcSlider.value = 1.2;
      noiseSlider.value = 0.7;
    } else if (name === 'flare') {
      tcSlider.value = 0.4;
      lcSlider.value = 0.8;
      noiseSlider.value = 0.85;
    } else if (name === 'lab') {
      tcSlider.value = 3.0;
      lcSlider.value = 3.5;
      noiseSlider.value = 0.03;
    }
    updateLabels();
    computeKernel();
  }

  function toggle5G() {
    fiveGOn = !fiveGOn;
    computeKernel();
  }

  function toggleDayNight() {
    isNight = !isNight;
    computeKernel();
  }

  function exportSnapshot() {
    const snapshot = {
      tc_ms: parseFloat(tcSlider.value),
      lc_nm: parseFloat(lcSlider.value),
      noise: parseFloat(noiseSlider.value),
      fiveGOn,
      isNight,
      timestamp: new Date().toISOString()
    };
    const blob = new Blob([JSON.stringify(snapshot,null,2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'qds_avian_lab_snapshot.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }

  tcSlider.addEventListener('input', () => { updateLabels(); computeKernel(); });
  lcSlider.addEventListener('input', () => { updateLabels(); computeKernel(); });
  noiseSlider.addEventListener('input', () => { updateLabels(); computeKernel(); });

  // init
  updateLabels();
  computeKernel();
</script>
</body>
</html>
